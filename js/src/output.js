/*const values = [
  [0.708, 0.737, 0.762, 0.722, 0.649, 0.739, 0.74, 0.843, 0.5],
  [0.6877173410244747, -2.3843593043400633, 2.077723319166359, 0.917913896968535, 2.862492987984076, 3.2964570949197673, -0.6498253174858168, 2.5542629027730848],
  [-2.5780145740966414, -0.28127474340400943, -7.931756789103304]
];

const weights = [
  [
    [9.949459076, 8.748355865, -0.549794495, 8.852907181, -1.064777613, 3.761207581, -4.782859325, -4.11353302],
    [-2.894866228, 2.887280941, 9.987085342, 2.577301741, -2.372628212, -2.698761463, -0.466041207, -7.711074352],
    [1.951831937, -9.99643898, 9.176095009, 6.981525898, -8.66497612, -7.932202339, 1.883320451, -9.973872185],
    [-1.210947633, -3.106406212, -1.044188976, 2.942449808, -9.981549263, -6.830992222, 0.842573404, -0.180096105],
    [4.632991314, 5.232639313, -8.097410202, -9.984016418, 4.64246273, 7.85969305, -3.247164488, 5.459958076],
    [8.811706543, -2.083108664, -4.352348804, -5.470148087, -1.216683269, 0.813924134, 0.529971063, -1.938149452],
    [-7.963445187, -2.393499136, -9.974265099, -9.981777191, 9.999266624, 8.630400658, -0.707756817, 9.999903679],
    [-7.828229904, 9.491410255, -8.572490692, -9.436075211, 9.999488831, 2.186549664, -1.36706841, 10],
    [-9.958322525, -9.998767853, 9.981740952, 9.770147324, -9.997897148, -9.998456955, 9.916462898, -9.996769905]
  ],
  [
    [1.190299273, -3.926170111, 2.315371752],
    [-0.329094201, -0.947514534, -8.00314045],
    [1.450993776, -2.795185804, 3.36390233],
    [2.640893698, 5.0679636, -7.63704443],
    [-1.407473803, -0.444837272, 3.4004457],
    [0.452742249, 1.850321531, -1.563089848],
    [-3.586490154, -4.362839699, 6.062557697],
    [-0.998973191, -2.825509787, 8.646045685]
  ]
];*/
const values = [
  [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5],
  [-0.2303666708832126, -0.7066185841504131, -0.20630919662903474, -0.2637588587560909, -0.18858480308092543, -0.7887836431629293, -0.9304188091583347, -0.7032119978944465, -1.210107464685579],
  [-0.7016245861392931, -0.6955007152167888, -0.6644595388825701, -0.6236961188809786, -0.6193123790267305, -0.6238969156100515, -0.6474872976676982, -0.6785929450795873, -0.670825225939447, -0.6157589580777346],
  [0.8930383342361654, 0.7985308280538426, 0.7718061903701772, 0.6916181006173279, 0.9002400939218486, 0.5722106303599602, 0.5779706396917708, 0.8846736874422204],
  [-8.724596311842332, -7.8399688064037335, 8.638102350389191]
];

const weights = [
  [
    [-1.2875941316848054, -6.10021026801245, -2.091452825926438, -1.4162837796548131, -1.2520361635918742, -5.824864262981822, -6.228055500661407, -5.380147065126997, -8.021552415585735],
    [-0.8117891586506941, -2.68827085831028, 4.093289404973216, -0.8980352506110427, 3.131304699944335, -3.719626484811246, -3.5637346516832697, -3.2573288887512666, -3.793204177315414],
    [-0.8026889157955074, -0.6828892964556997, 3.5328964262171256, -0.8614742525509478, 2.5624314676827615, -2.2204867449211343, -2.413969057363735, -2.1424612686788866, -3.203131088617688],
    [-0.5616949551274122, -1.081786003900667, 0.3238938126801249, -0.5942550724532519, 0.5419480851516505, -0.3926773205120624, -0.9173406410043257, -0.5934568075781655, -1.8088776842035938],
    [0.017319109444398746, -0.5543695395127674, 2.3274067682985313, -0.08661441720709631, 1.6605791213807561, -2.340228014134269, -1.8107109527313654, -1.8881034475015095, -1.3229727389344172],
    [-0.5522968514799748, 2.4265105982131185, 1.758205014415246, -0.4161856922110249, 0.9159772256912502, 1.0516854214135432, 0.6747713831050733, 0.732425047268771, -0.17956138609226047],
    [0.6541946628152743, 0.8415314410350213, -7.0289447653755275, 0.8948168306675832, -5.303156525691023, 5.413819406435317, 4.615434695958824, 4.535828594169228, 4.225611915710194],
    [0.7490614697034714, -0.8155557311715975, -3.013105775602692, 1.1122559572517194, -1.880799802951797, 6.825048571607048, 6.472649214854106, 6.045472689623601, 7.381013915189954],
    [0.7337922088880233, 9.99992246175748, 8.046873782052995, 0.7845716497167726, 6.3318214035794, 0.13649705486776692, 1.400188048892039, 0.6593030138242317, 3.8765251838437105]
  ],
  [
    [0.21483067262563907, 0.20590812260975738, 0.03558440297162032, 0.1966781256323464, 0.3424971478649434, 0.2620188113890959, 0.28381453231285536, 0.18239767834410214, 0.2834909915670303, 0.1571339562159104],
    [2.132252978316997, 2.1779208653037614, 1.1798313969062306, 1.8279850487254203, 2.683240149317821, 2.229076337332066, 2.498346739231737, 2.077697640193884, 2.5234919800772104, 2.078290261034899],
    [-3.659390587376357, -3.641827476774317, -3.1985697593251423, -3.3981622703935774, -4.441947527613295, -3.726795781023497, -4.105350956660965, -3.5987702936037995, -4.159513008358427, -3.612586759589611],
    [0.3126697154056113, 0.34266490629238416, 0.04017399408808851, 0.2751217779581625, 0.5473932584472555, 0.3035991058178448, 0.4515335720161979, 0.3414678606471264, 0.44377493920350897, 0.3086911172186136],
    [-2.871669462959705, -2.9645200633857423, -2.593477483096307, -2.795960250896404, -3.4503604936304004, -2.968887126639428, -3.2210076469210978, -2.8607954022082045, -3.2302148384716136, -2.8257428417660253],
    [2.7890690161435012, 2.8581198168944657, 1.499406181863405, 2.2465019923559635, 4.11474301223238, 2.9654245285109115, 3.601454718446665, 2.641614211629577, 3.6137307441547457, 2.6885140269721175],
    [2.622239526466711, 2.6939414609341887, 1.4590921238971497, 2.200542511975641, 3.8297674235312784, 2.757508321042711, 3.3475905967171053, 2.5590358655909053, 3.382919829992083, 2.5058714325223423],
    [2.4116614667628844, 2.507352544490663, 1.304233137513826, 2.0266488651914654, 3.57667883315404, 2.600175091739819, 3.1489285660486046, 2.386813859038829, 3.238474111489281, 2.3233985766279392],
    [2.9153858986093137, 2.9577373797324467, 1.7200637768474358, 2.4540537686422894, 4.108077850717308, 3.1012410454469346, 3.5896238235787647, 2.8566889362929198, 3.7372702247796696, 2.8237079358363752]
  ],
  [
    [-1.3728658052466833, -1.380745318971731, -1.3658673850713317, -1.3543318507551039, -1.329553517846868, -1.4086343864545474, -1.4041859988002832, -1.317646604895552],
    [-1.3922514461494326, -1.392389162864658, -1.4149108958982552, -1.4091278869783317, -1.3072688603243958, -1.476364494232695, -1.471935361022567, -1.3343897160837328],
    [-0.8175523086367892, -0.9539761257146697, -0.9285946671529262, -0.9922628156773223, -0.8414501570447225, -1.0288928266461441, -0.9749673864997235, -0.8255861123088614],
    [-1.1301966499818599, -1.1443277390718225, -1.2233197664907214, -1.2210110563789776, -1.1590057265585403, -1.297295509665448, -1.2518153194803656, -1.1012958772271069],
    [-2.0495908215154164, -2.02055054781107, -2.0037240603067654, -2.046613803525399, -2.0049618064551944, -1.9524621423620723, -1.958115503542026, -2.0709354691030257],
    [-1.394988757409957, -1.4711764201887467, -1.4501777112437482, -1.4687860324732473, -1.4319239430332535, -1.5338798547911565, -1.440700929196291, -1.4450967329630775],
    [-1.6797733646761244, -1.7516629526619327, -1.7048156115936348, -1.7411644712059433, -1.7267921729744549, -1.7780090968429016, -1.7619292470240708, -1.7496420674662028],
    [-1.3351440842023836, -1.3079013411070475, -1.3723984809010952, -1.3830085704625334, -1.259464819256476, -1.3461616120299906, -1.4225601090207083, -1.259271152893018],
    [-1.7743997933870626, -1.7476975123271856, -1.8115565938664568, -1.7310017348721525, -1.792016003809807, -1.7710518684360255, -1.7920359127843732, -1.7431400013387086],
    [-1.2559883458378835, -1.352821137765466, -1.3381980332118337, -1.3395466166935377, -1.3307260948005428, -1.4117668651136703, -1.3593845287816435, -1.278556427068019]
  ],
  [
    [1.610342919672434, 1.6312027581507147, -1.83823851339039],
    [1.6977507111728778, 1.3641362335963385, -1.9010730796280642],
    [1.6977754130151665, 1.2902967453225684, -1.9505856939176154],
    [1.68552866857567, 1.1278237542205454, -1.9481371084623889],
    [1.5958109695698588, 1.6450126396524747, -1.8209140412340032],
    [1.7463999081761747, 0.8123708078986057, -1.9840455108408575],
    [1.7027153305548446, 0.8844376818021077, -1.9379292758282787],
    [1.6152291821141516, 1.6403683098167523, -1.8027045203331797]
  ]
];

var KPNN = new NeuralNetwork(values, weights);
var maxW = 0;
var maxH = 0;
const padding = 60;
const scl = 70;
function setup() {
  frameRate(10);
  cnv = createCanvas(getSize()[0], getSize()[1]);
  cnv.parent('sketch-holder');
}
function getSize() {
  for (var i = 0; i < KPNN.layers.length; i++) {
    maxW = KPNN.layers[i].neurons.length > maxW ? KPNN.layers[i].neurons.length : maxW;
  }
  maxH = KPNN.layers.length - 1;
  return [2 * padding + maxW * scl, 2.1 * padding + (maxH - 1) * 2.4 * scl];
}
function resizeAccordingly() {
  resizeCanvas(getSize()[0], getSize()[1]);
}
function draw() {
  background(51);
  // loop door de lagen heen
  for (var n = 0; n < KPNN.layers.length; n++) {
    var y = map(n, 0, maxH, padding, height - padding);
    // loop door de neurons heen
    for (var k = 0; k < KPNN.layers[n].neurons.length; k++) {
      var horOffSet = (maxW - KPNN.layers[n].neurons.length) / 2 + 0.5;
      var x = map(k + horOffSet, 0, maxW, padding, width - padding);
      KPNN.layers[n].neurons[k].x = x;
      KPNN.layers[n].neurons[k].y = y;
      if (n !== KPNN.layers.length - 1) {
        // loop door de weights
        for (var b = 0; b < KPNN.layers[n + 1].neurons.length; b++) {
          var horOffset2 = (maxW - KPNN.layers[n + 1].neurons.length) / 2 + 0.5;
          KPNN.layers[n + 1].neurons[b].x = map(b + horOffset2, 0, maxW, padding, width - padding);
          KPNN.layers[n + 1].neurons[b].y = map(n + 1, 0, maxH, padding, height - padding);
          var x2 = KPNN.layers[n + 1].neurons[b].x;
          var y2 = KPNN.layers[n + 1].neurons[b].y;
          if (KPNN.layers[n].neurons[k].weights[b].value > 0) {
            stroke(map(KPNN.layers[n].neurons[k].weights[b].value, 0, 10, 0, 255), 0, 0);
          } else {
            stroke(0, 0, map(KPNN.layers[n].neurons[k].weights[b].value, -10, 0, 255, 0));
          }
          strokeWeight(1);
          line(x, y, x2, y2);
        }
      }
      fill(map(KPNN.layers[n].neurons[k].value, 0, 1, 255, 0), map(KPNN.layers[n].neurons[k].value, 0, 1, 255, 0), 255);
      stroke(0);
      strokeWeight(2);
      ellipse(x, y - 3, 0.7 * scl);
      textAlign(CENTER);
      fill(0);
      noStroke();
      textSize(14);
      text(KPNN.layers[n].neurons[k].value.toFixed(3), x, y);
      textSize(20);
      textAlign(LEFT);
      fill(255);
      stroke(51);
      text("Credits: Simbrain, P5.js", 20, height - 20);
    }
  }
}